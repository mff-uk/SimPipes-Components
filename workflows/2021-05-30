# Load datasets exported from EDP using LP:ETL
# https://etl.opendata.cz/working/data/1619600412136-891-a01d1d32-987e-40e0-aab4-8eb09bbbe671/working/working-outputfiles-21/edp.trig
# and convert it to CSV.

DATASET = https://odsim.opendata.cz/soubor/2021-05-30-edp.trig
DIR = ./data/2021-05-30
PYTHON = python3

all: data/shared/2021.05.30.trig
	mkdir -p ./data/2021-05-30-edp/datasets
	$(PYTHON) ../extractors/extract-metadata-descriptor/dcat-ap-extractor/dcat-ap-extractor.py --input ./data/shared/2021.05.30.trig --language en --output $(DIR)/datasets
	$(PYTHON) ../processors/refine-descriptor/json-to-csv/json-to-csv.py --input $(DIR)/datasets --output $(DIR)/titles-en.csv --property title-en
	$(PYTHON) ../processors/refine-descriptor/json-to-csv/json-to-csv.py --input $(DIR)/datasets --output $(DIR)/description-en.csv --property description-en
	$(PYTHON) ../processors/refine-descriptor/json-to-csv/json-to-csv.py --input $(DIR)/datasets --output $(DIR)/keywords-en.csv --property keywords-en --linePerValue

data/shared/2021.05.30.trig:
	mkdir -p ./data/shared
	wget "$(DATASET)" -O ./data/shared/2021.05.30.trig
